{% extends "layout.html" %}

{% block title %}
Admin things
{% endblock %}

<script>
function confirmDelete() {
    return confirm("Are you sure you want to delete this?");
}
</script>

{% block main %}
    <h1>Admin Dashboard</h1>
    <h2>Users</h2>
    <ul>
        {% for user in users %}
        <li>{{ user.username }} {% if user.is_admin %} - Admin{% endif %}</li>
        {% if (session.get('user_id')|int) != user.id %}
        <form method="post" style="display:inline;">
                <input type="hidden" name="delete_user" value="true">
                <input type="hidden" name="user_id" value="{{ user.id }}">
                <button onsubmit="confirmDelete()" type="submit">Delete User</button>
            </form>
            
            <form method="post" style="display:inline;">
                <input type="hidden" name="promote_user" value="true">
                <input type="hidden" name="user_id" value="{{ user.id }}">
                <button type="submit">
                    {% if user.is_admin %}
                        Revoke Admin
                    {% else %}
                        Make Admin
                    {% endif %}
                </button>
            </form>
            {% endif %}
        {% endfor %}
    </ul>

    <h2>Posts</h2>
    <ul>
        {% for post in posts %}
            <li>{{ post.username }} - {{ post.title }} - {{ post.body }}</li>
            <form method="post" style="display:inline;">
                <input type="hidden" name="delete_post" value="true">
                <input type="hidden" name="post_id" value="{{ post.id }}">
                <button onsubmit="confirmDelete()" type="submit">Delete Post</button>
            </form>
        {% endfor %}
    </ul>    
{% endblock %}